<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vertical Snap-Scroll Site</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500&display=swap" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <style>
      /* === CSS Variables for Theming === */
      :root {
        --bg-color: #000;
        --real-vh: 100vh; /* */
--text-color: #fff;
        --text-muted-color: #6b7280;
        --border-color: #4b5563;
        --accent-color: #1f2937; /* For section numbers */
        --sphere-color: 0xffffff;
/* THREE.js color */
      }

      body.light-mode {
        --bg-color: #ffffff;
--text-color: #000000;
        --text-muted-color: #4b5563;
        --border-color: #d1d5db;
        --accent-color: #e5e7eb;
        --sphere-color: 0x000000;
}

      /* === Base Styles === */
      * {
        box-sizing: border-box;
margin: 0;
        padding: 0;
        -webkit-tap-highlight-color: transparent;
        -webkit-focus-ring-color: transparent;
        outline: none;
}

      html {
        height: 100%;
/* Hide scrollbar */
        -ms-overflow-style: none;
/* IE and Edge */
        scrollbar-width: none;
/* Firefox */
      }
      html::-webkit-scrollbar {
        display: none;
/* Chrome, Safari */
      }

      body {
        font-family: 'Inter', sans-serif;
/* Hide scrollbar */
        -ms-overflow-style: none;
/* IE and Edge */
        scrollbar-width: none;
/* Firefox */

        /* UPDATED: Single source of truth for color transitions */
        background-color: var(--bg-color);
color: var(--text-color);
        transition: background-color 0.3s ease, color 0.3s ease;
      }

      body.modal-active {
        overflow: hidden;
}

      /* Wrapper controls theme and layout */
      .theme-wrapper {
        background-color: var(--bg-color);
color: var(--text-color);
        /* transition: background-color 0.3s ease, color 0.3s ease;
*/ /* REMOVED */
        height: 100vh; /* */
        height: var(--real-vh); /* */
        overflow-x: hidden;
        overflow-y: auto; 
        scroll-snap-type: y mandatory;
position: relative; /* Needed for z-index stacking */
      }


      /* Hide scrollbar for Chrome, Safari and Opera */
      body::-webkit-scrollbar {
        display: none;
}

      /* === Main Container for Scrolling === */
      main {
        width: 100vw;
position: relative; 
        z-index: 10; /* Sit on top of canvas */
      }


      /* === MOBILE: Default Section Layout (Vertical) === */
      section {
        height: 100vh; /* */
        height: var(--real-vh); /* */
width: 100vw;
        display: flex;
        overflow: hidden;
        padding: 2rem 1.5rem 8rem;
/* Make space for footer */
        /* transition: background-color 0.3s ease;
*/ /* REMOVED */
        background-color: var(--bg-color);

        scroll-snap-align: start;
        scroll-snap-stop: always;

        position: relative;
}

      #section-1 {
        background-color: transparent;
}

      /* === Content Animation (UPDATED) === */

      #canvas-container {
        opacity: 0;
transition: opacity 1.5s ease-in-out; /* MODIFIED: Made smoother */
      }

      #canvas-container.is-visible {
        opacity: 1;
transition-delay: 0.2s; /* Stagger start time */
      }

      .hero-text-large,
      .text-divider,
      .section-content {
        opacity: 0;
transform: translateY(20px);
        transition: opacity 0.7s cubic-bezier(0.23, 1, 0.32, 1), 
          transform 0.7s cubic-bezier(0.23, 1, 0.32, 1);
}

      section.is-active .hero-text-large,
      section.is-active .text-divider,
      section.is-active .section-content {
        opacity: 1;
transform: translateY(0);
      }

      section.is-active .hero-text-large { transition-delay: 0.4s;
}
      section.is-active .text-divider { transition-delay: 0.6s;
}
      section.is-active .section-content { transition-delay: 0.4s;
}


      #theme-checkbox {
        display: none;
}

      a {
        color: inherit;
        text-decoration: none;
}

      button {
        background: none;
        border: none;
padding: 0;
        color: inherit;
        cursor: pointer;
      }

      .nav-link:hover, .nav-link-left:hover, .mobile-footer-links a:hover {
        color: var(--text-color);
background-color: var(--accent-color);
      }

      .logo-button.active {
        /* This class is now used to keep the logo visible */
      }

      /* === DESKTOP: Side Navs === */

      .nav-stacked-right {
        top: 0;
right: 0;
        height: 100%;
        z-index: 100;
        display: none; /* Hidden by default */
        flex-direction: row;
flex-shrink: 0; 
        border-left: 1px solid var(--border-color);
        background-color: var(--bg-color);
        /* transition: border-color 0.3s ease, background-color 0.3s ease;
*/ /* REMOVED */
        /* --- ADDED TRANSITION FOR BORDER --- */
        transition: border-width 0.5s cubic-bezier(0.76, 0, 0.24, 1),
          transform 0.8s cubic-bezier(0.23, 1, 0.32, 1) 0.5s;
/* MODIFIED: Added transform transition */
        
        /* --- NEW: Initial state for animation --- */
        transform: translateY(-100%);
}

      /* --- ADDED RULE TO HIDE BORDER --- */
      .nav-stacked-right.is-complete {
        border-left-width: 0;
}

      .nav-stacked-right .nav-link {
        display: flex;
        flex-direction: column;
justify-content: space-between;
        align-items: center;
        height: 100%;
        width: 2rem;
        padding: 2rem 0rem;
        border-left: 1px solid var(--border-color);
transition: background-color 0.3s ease, /* Keep hover transition */
          width 0.5s cubic-bezier(0.76, 0, 0.24, 1), 
          padding 0.5s cubic-bezier(0.76, 0, 0.24, 1), 
          opacity 0.3s ease,
          border-width 0.5s cubic-bezier(0.76, 0, 0.24, 1);
overflow: hidden;
      }

      .nav-stacked-right .nav-link:first-child {
        border-left: none;
}

      .nav-stacked-right .nav-link.active {
        width: 0;
        padding-left: 0;
padding-right: 0;
        opacity: 0;
        border-left-width: 0;
      }

      .nav-stacked-right .nav-number, .nav-link-left .nav-number {
        font-size: 0.875rem;
}

      .nav-stacked-right .nav-text, .nav-link-left .nav-text {
        font-size: 0.875rem;
letter-spacing: 0.1em;
        text-transform: uppercase;
      }

      .vertical-text {
        writing-mode: vertical-rl;
}

      .nav-stacked-left .vertical-text {
        transform: rotate(180deg);
}

      .sidebar-left {
        top: 0; 
        left: 0;
padding: 1.5rem 0;
        z-index: 10; 
        display: none; /* Hidden by default */
        flex-direction: column;
height: 100%;
        justify-content: space-between;
        align-items: center;
        border-right: 1px solid var(--border-color);
        width: 2.5rem;
        flex-shrink: 0; 

        background-color: var(--bg-color);
/* transition: border-color 0.3s ease, background-color 0.3s ease; */ /* REMOVED */
        
        /* --- NEW: Added transition and initial state --- */
        transform: translateY(-100%);
transition: transform 0.8s cubic-bezier(0.23, 1, 0.32, 1) 0.5s;
      }

      /* === FIX: Reverted to original layout and added animation === */
      .nav-stacked-left {
        top: 0;
height: 100%;
        z-index: 100;
        display: none; /* Hidden by default (for mobile) */
        flex-direction: row;
/* Corrected: Was 'column' */
        border-right: 1px solid var(--border-color);
/* Added back */
        flex-shrink: 0; 
        background-color: var(--bg-color);
/* --- NEW: Added transition and initial state --- */
        transform: translateY(-100%);
transition: transform 0.8s cubic-bezier(0.23, 1, 0.32, 1) 0.5s;
      }
      /* === END FIX === */

      .nav-link-left {
        display: flex;
flex-direction: column;
        justify-content: space-between;
        align-items: center;
        height: 100%;
        padding: 2rem 0rem;
        border-left: 1px solid var(--border-color);
transition: background-color 0.3s ease, /* Keep hover transition */
          width 0.5s cubic-bezier(0.76, 0, 0.24, 1), 
          padding 0.5s cubic-bezier(0.76, 0, 0.24, 1), 
          opacity 0.3s ease,
          border-width 0.5s cubic-bezier(0.76, 0, 0.24, 1);
overflow: hidden;
        width: 0;
        padding-left: 0;
        padding-right: 0;
        opacity: 0;
        border-left-width: 0;
}

      .nav-link-left:first-child { border-left: none;
}

      .nav-link-left.active {
        width: 2rem;
        padding: 2rem 1rem;
opacity: 1;
        border-left-width: 1px;
      }
      .nav-link-left.active:first-child { border-left-width: 0;
}

      /* --- NEW: Desktop Nav Intro Animation --- */
      .theme-wrapper.is-loaded .nav-stacked-right,
      .theme-wrapper.is-loaded .sidebar-left, /* MODIFIED: Added .sidebar-left */
      .theme-wrapper.is-loaded .nav-stacked-left {
        transform: translateY(0);
}


      /* === MOBILE: Header & Footer === */

      .mobile-footer {
        position: fixed;
bottom: 0;
        left: 0;
        width: 100%;
        z-index: 100;
        display: flex;
        flex-direction: column;
        background-color: var(--bg-color);
        border-top: 1px solid var(--border-color);
/* transition: background-color 0.3s ease, border-color 0.3s ease; */ /* REMOVED */
      }

      .mobile-footer-top {
        display: grid;
grid-template-columns: 1fr 1fr 1fr; 
        align-items: center;
        padding: 1rem 1.5rem;
        border-bottom: 1px solid var(--border-color);
        /* transition: border-color 0.3s ease;
*/ /* REMOVED */
      }

      .mobile-footer-top .info-button {
        justify-self: start;
}
      .mobile-footer-top .logo-button { 
        justify-self: center;
}
      .mobile-footer-top .theme-toggle-label {
        justify-self: end;
}

      .mobile-footer-links {
        display: grid;
grid-template-columns: 1fr 1fr 1fr; 
      }

      .mobile-footer-links a {
        text-align: center;
padding: 1rem 0.5rem;
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        border-left: 1px solid var(--border-color);
        transition: background-color 0.3s ease;
/* Keep hover transition */
        color: var(--text-muted-color);
}
      .mobile-footer-links a:first-child {
        border-left: none;
}
      .mobile-footer-links a.active {
        color: var(--text-color);
        background-color: var(--accent-color);
}

      /* === NEW: Mobile Work Nav (Section 2) === */
      #mobile-work-nav {
        /* display: none;
*/ /* MODIFIED: No longer using display */
        /* NEW: Slide-in/out styles */
        overflow: hidden;
max-height: 0;
        transform: translateY(100%);
        transition: max-height 0.4s cubic-bezier(0.23, 1, 0.32, 1), 
          transform 0.4s cubic-bezier(0.23, 1, 0.32, 1),
          border-width 0.1s linear;
border-bottom: 0px solid var(--border-color); /* Start with no border */
        display: grid;
/* ADDED: Keep as grid */
        grid-template-columns: 1fr 1fr 1fr;
/* ADDED: Keep as grid */
      }

      /* When on section 2, hide main links and show work links */
      /* .mobile-footer.section-2-active .mobile-footer-links {
      display: none;
} */ /* REMOVED: We want to show all menus */
      .mobile-footer.section-2-active #mobile-work-nav {
        /* display: grid;
*/ /* REMOVED */
        /* grid-template-columns: 1fr 1fr 1fr;
*/ /* MOVED */

        /* NEW: Slide-in styles */
        max-height: 60px;
/* Adjust as needed for padding */
        transform: translateY(0);
        border-bottom-width: 1px;
transition-delay: 0s, 0s, 0.3s; /* Delay border appearing */
      }

      /* Styling for the new work-nav links */
      .mobile-work-nav-link {
        text-align: center;
padding: 0.75rem 0.5rem;
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        border-left: 1px solid var(--border-color);
        transition: background-color 0.3s ease;
        color: var(--text-muted-color);
cursor: pointer;
        /* === NEW: Added for progress bar === */
        position: relative;
overflow: hidden;
      }
      .mobile-work-nav-link:first-child {
        border-left: none;
}
      .mobile-work-nav-link.active,
      .mobile-work-nav-link:hover {
        color: var(--text-color);
background-color: var(--accent-color);
      }

      /* === NEW: Progress bar for mobile link === */
      .mobile-work-nav-link.active::before {
        content: '';
position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        width: var(--progress, 0%);
/* Controlled by JS */
        background: var(--text-color);
        transition: width 0.1s linear;
        z-index: 0;
}

      /* === NEW: Span to allow text to sit above bar === */
      .mobile-work-nav-link span {
        position: relative;
z-index: 1;
        background: linear-gradient(to right, var(--text-color) var(--progress, 0%), var(--text-color) var(--progress, 0%), var(--text-color) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
/* Force span to take up full button area for alignment */
        display: flex;
align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
      }

      /* === NEW: Active state text color change === */
      .mobile-work-nav-link.active span {
        background: linear-gradient(
          to right, 
          var(--bg-color) var(--progress, 0%), 
          var(--text-color) var(--progress, 0%), 
          var(--text-color) 100%
        );
-webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      /* === END: Mobile Work Nav === */


      /* === Icon Button Base Class === */
      .icon-button {
        width: 2rem;
height: 2rem;
        border-radius: 50%;
        cursor: pointer;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
/* transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease, opacity 0.3s ease;
*/ /* REMOVED */
        transition: opacity 0.3s ease;
}

      .icon-button svg {
        width: 1.25rem;
/* 20px */
        height: 1.25rem;
/* 20px */
        fill: currentColor;
        transition: transform 0.3s ease;
}

      /* === SVG Logo Button Styles === */
      .logo-button {
        width: 2rem;
height: 2rem;
        border-radius: 50%;
        cursor: pointer;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 1px solid var(--text-color);
        background-color: var(--bg-color);
/* Dark circle */
        color: var(--text-color);
/* Light SVG */
        /* transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease, opacity 0.3s ease;
*/ /* REMOVED */
        transition: opacity 0.3s ease;
}

      .logo-button:hover {
        opacity: 0.8;
        background-color: var(--bg-color);
/* Keep bg on hover */
      }

      .logo-svg {
        width: 1.25rem;
/* 20px */
        height: 1.25rem;
/* 20px */
        transition: transform 0.5s ease;
}

      .logo-button:hover .logo-svg {
        transform: scale(0.9);
}

      /* SVG dot styles */
      .dot {
        position: absolute;
/color: var(--bg-color); 
        width: 0.3rem; /* 5px */
        height: 0.3rem;
/* 5px */
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: var(--text-color);
/* Light dot */
        border-radius: 50%;
        transition: transform 0.5s ease;
}

      .dot-bottom {
        bottom: -0.1rem;
/* -2.5px */
        left: 50%;
        transform: translateX(-50%);
        transform-origin: 0.15625rem -0.84375rem;
/* Corrected: 2.5px -13.5px */
      }
      .dot-left {
        left: 0.0rem;
/* 1px */
        top: 20%;
        transform: translateY(-50%);
        transform-origin: 0.9375rem 0.6rem;
/* 15px 9.6px */
      }
      .dot-right {
        right: 0.0rem;
/* 1px */
        top: 20%;
        transform: translateY(-50%);
        transform-origin: -0.8125rem 0.6rem;
/* -13px 9.6px */
      }

      .logo-button:hover .dot-bottom {
        transform: translateX(-50%) rotate(360deg);
}
      .logo-button:hover .dot-left {
        transform: translateY(-50%) rotate(360deg);
}
      .logo-button:hover .dot-right {
        transform: translateY(-50%) rotate(360deg);
}


      /* SVG icon styles */
      .st0, .st3, .st5, .st7 {
        stroke: currentColor;
stroke-miterlimit:10;
      }
      .st0 { stroke-width:10; }
      .st3, .st7 { stroke-width:5;
}
      .st7 { fill: none;
}
      .st4, .st6 { fill: currentColor;
}
      .st1 { display: none;
}
      .st2, .st5, .st6 { display: inline;
}
      /* === END SVG Logo Styles === */


      /* Theme Toggle Button */
      #theme-toggle {
        /* Uses .icon-button */
        border: 1px solid var(--text-color);
background-color: var(--text-color);
        color: var(--bg-color);
      }

      .theme-toggle-label:hover #theme-toggle #theme-dot {
        transform: scale(1.25);
}

      #theme-dot {
        width: 0.8rem;
        height: 0.8rem;
border-radius: 50%;
        background-color: currentColor;
        transition: transform 0.3s ease;
      }

      /* Info Button */
      .info-button {
        /* Uses .icon-button */
        border: 1px solid var(--text-color);
background-color: var(--text-color);
        color: var(--bg-color);
      }

      .info-button:hover svg {
        transform: scale(1.25);
}

      .desktop-info-button {
        writing-mode: vertical-rl;
        margin-bottom: 1.5rem;
}


      /* === Section 1: Hero === */

      .section-1-wrapper {
        display: flex;
flex-direction: column;
        width: 100%;
      }

      .section-grid {
        display: flex;
flex-direction: column;
        width: 100%;
      }

      #canvas-container {
        position: fixed;
top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: 1;
/* Behind content */
        display: flex;
        align-items: center;
        justify-content: center;
}

      .text-column {
        flex-grow: 1;
        flex-basis: 50%;
display: none; /* Hiding text column */
        flex-direction: column;
        justify-content: center;
        padding-top: 2rem;
}

      .hero-text-large {
        font-size: 1.5rem;
        line-height: 1.6;
font-weight: 300;
      }

      .text-divider {
        margin-top: 2rem;
padding-top: 2rem;
        border-top: 1px solid var(--border-color);
        font-size: 0.875rem;
        line-height: 1.6;
        color: var(--text-muted-color);
        /* transition: border-color 0.3s ease, color 0.3s ease;
*/ /* REMOVED */
      }

      .brand-name {
        color: var(--text-color);
font-weight: 500;
        /* transition: color 0.3s ease; */ /* REMOVED */
      }

      /* === Sections 2-5 (Shared Styles) === */
      .section-title-combined {
        font-size: 1.875rem;
line-height: 1.4;
        font-weight: 400;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
}

      .section-number-inline {
        font-size: 0.875rem;
        color: var(--text-muted-color);
background-color: var(--accent-color);
        padding: 0.25rem 0.75rem;
        border-radius: 99px;
        margin-bottom: 1rem;
        /* transition: background-color 0.3s ease, color 0.3s ease;
*/ /* REMOVED */
      }

      .section-description {
        font-size: 1.125rem;
line-height: 1.7;
        color: var(--text-muted-color);
        margin-top: 1.5rem;
        max-width: 65ch;
      }

      .center-section {
        align-items: center;
justify-content: center;
        text-align: left;
      }

      /* === Marquee Styles === */
      .marquee-container {
        width: 100%;
padding: 0.1rem 0;
        background-color: var(--bg-color); /* Match section bg */
        border-top: 1px solid var(--border-color);
border-bottom: 1px solid var(--border-color);
        overflow: hidden;
        white-space: nowrap;
        /* transition: background-color 0.3s ease, border-color 0.3s ease;
*/ /* REMOVED */
        margin-top: 20rem;

        position: relative; 
        z-index: 5;
/* --- MODIFIED: Intro Animation --- */
        transform: translateX(100%);
transition: transform 0.8s cubic-bezier(0.23, 1, 0.32, 1);
      }

      /* --- NEW: Marquee Animation Trigger --- */
      section.is-active .marquee-container {
        transform: translateX(0);
transition-delay: 0.5s; /* Stagger after canvas fade-in */
      }


      .marquee-content-wrapper {
        display: flex;
width: fit-content; 
        animation: marquee-scroll 80s linear infinite;
      }

      .marquee-content {
        display: flex;
white-space: nowrap; 
      }

      .marquee-content span {
        font-size: 5rem;
font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        color: var(--text-color);
        /* transition: color 0.3s ease;
*/ /* REMOVED */
        padding-right: 2rem;
}


      /* === MODAL STYLES (THEMED) === */
      #modal-container-side {
        position: fixed;
/* Default for mobile */
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
z-index: 200;
        pointer-events: none;
        opacity: 0; 
      }

      #modal-container-side.visible {
        pointer-events: auto;
animation: containerFadeIn 0.5s cubic-bezier(0.165, 0.840, 0.440, 1.000) forwards;
      }

      #modal-container-side.visible.out {
        animation: containerFadeOut 0.5s cubic-bezier(0.165, 0.840, 0.440, 1.000) forwards;
}

      #modal-container-side.visible .modal-content {
        opacity: 0;
animation: fadeIn 0.5s cubic-bezier(0.165, 0.840, 0.440, 1.000) forwards;
      }

      #modal-container-side.visible.out .modal-content {
        animation: fadeOut 0.4s cubic-bezier(0.165, 0.840, 0.440, 1.000) forwards;
}

      .modal-background {
        display: flex;
        justify-content: center;
align-items: center;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.75);
}

      .modal-content {
        background: var(--bg-color);
        color: var(--text-color);
display: flex; 
        width: 80vw;
        height: 70vh;
        max-width: 1200px;
        border-radius: 8px;
        font-weight: 300;
        position: relative;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
overflow: hidden; 
      }

      .modal-panel {
        width: 50%;
/padding: 25px;
        overflow-y: auto;
      }

      .modal-panel.left {
        border-right: 1px solid var(--border-color);
}

      .modal-panel h2 {
        font-size: 25px;
        /line-height: 25px;
margin-bottom: 15px;
        color: var(--text-color);
      }

      .modal-panel p {
        font-size: 1.25rem;
color: var(--text-color);
        font-weight: 500;
      }

      @media (max-width: 768px) {
        .modal-content {
          flex-direction: column;
width: 100vw;
          height: 80vh;
        }
        
        /.modal-background {
    background: rgba(0, 0, 0, 1);
}
        
        .modal-panel {
          width: 100%;
height: 50%;
        }
        .modal-panel.left {
          border-right: none;
border-bottom: 1px solid var(--border-color);
        }
      }

      /* --- KEYFRAMES --- */

      @keyframes marquee-scroll {
        0% { transform: translateX(0);
}
        100% { transform: translateX(-50%);
}
      }

      @keyframes containerFadeIn {
        0% { opacity: 0;
}
        100% { opacity: 1;
}
      }
      @keyframes containerFadeOut {
        0% { opacity: 1;
}
        100% { opacity: 0;
}
      }
      @keyframes fadeIn {
        0% { opacity: 0;
transform: translateY(10px); }
        100% { opacity: 1; transform: translateY(0);
}
      }
      @keyframes fadeOut {
        0% { opacity: 1;
transform: translateY(0); }
        100% { opacity: 0; transform: translateY(10px);
}
      }
      /* === END MODAL STYLES === */

      /* === Section Z-Indexes === */
      #section-1 { z-index: 10;
}
      #section-2 { z-index: 12; }
      #section-3 { z-index: 13;
}
      #section-4 { z-index: 14;
}


      /* * === CONSOLIDATED MEDIA QUERIES === 
      */
      @media (min-width: 1025px) {
        .theme-wrapper {
          overflow: hidden;
scroll-snap-type: none;
          display: flex;
          flex-direction: row;
        }

        main {
          overflow: hidden;
flex-grow: 1;
          height: 100vh;
          width: 100%;
        }

        section {
          position: absolute;
top: 0; 
          left: 0; 
          height: 100%;
          width: 100%;
          /* UPDATED: Removed background-color transition */
          transition: transform 0.8s cubic-bezier(0.76, 0, 0.24, 1);
transform: translateX(100%); 
          padding: 4rem 0rem;
        }

        #section-1 {
          transform: translateX(0);
}

        /* Show/Hide UI */
        .mobile-footer {
          display: none;
}
        .nav-stacked-right, .sidebar-left, .nav-stacked-left {
          display: flex;
}

        /* Section 1 Layout */
        .section-grid {
          flex-direction: row;
align-items: stretch;
        }
        .section-1-wrapper {
          height: auto;
justify-content: center;
        }

        .text-column {
          padding-top: 0;
padding-left: 2rem;
        }

        /* Typography */
        .section-title-combined {
          font-size: 2.5rem;
}

        /* Desktop Modal Styles */
        #modal-container-side {
          position: absolute;
/* Fit to <main> */
          z-index: 200;
/* Stay on top of sections */
        }

        .modal-content {
          width: 100%;
height: 100%;
          max-width: none;
          border-radius: 0;
          box-shadow: none;
        }
      }

      @media (min-width: 768px) {
        .hero-text-large {
          font-size: 1.875rem;
}

        .section-title-combined {
          font-size: 2.5rem;
}
      }

 

    </style>
    
    -->
    <script>
      function setRealViewportHeight() {
        let vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--real-vh', `${vh * 100}px`);
      }
      setRealViewportHeight();
      window.addEventListener('resize', setRealViewportHeight);
      window.addEventListener('orientationchange', setRealViewportHeight);
    </script>
    
  </head>
  <body>

    <input type="checkbox" id="theme-checkbox">

    <div class="theme-wrapper">

      <div id="canvas-container">
      </div>

      <footer class="mobile-footer">
       
 <div class="mobile-footer-links-work" id="mobile-work-nav">
          <a href="#" class="mobile-work-nav-link active" data-gallery="3d"><span>3D</span></a>
          <a href="#" class="mobile-work-nav-link" data-gallery="graphic"><span>Graphic</span></a>
          <a href="#" class="mobile-work-nav-link" data-gallery="product"><span>Product</span></a>
        </div>
        <div class="mobile-footer-top">
       
   <button id="mobile-about-button" class="icon-button info-button" aria-label="About">
            <svg viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
            </svg>
          </button>
  
        <a href="#section-1" data-navlink="section-1" class="nav-link logo-button active">
            <svg class="logo-svg" viewBox="0 0 712.7 712" xmlns="http://www.w3.org/2000/svg">
              <polyline class="st0" points="640,628.1 640,443.7 645.9,427.9 645.9,315.1 640,300.3 640,88.5 648.1,71.8 655.2,57.1 685.6,57.1 	707.7,68.8 707.7,82.8 707.7,635.7 700.8,644.1 692.2,652.7 653.3,652.7 "/>
              <polygon class="st0" points="640,327.8 630,327.8 623,339.2 500.2,339.2 485.8,327.8 476.6,327.8 476.6,408.5 485.2,408.5 	498.3,398.5 615.8,398.5 629.1,408.5 640,408.5 "/>
          
    <polyline class="st0" points="476.6,628.1 476.6,443.7 470.6,427.9 470.6,315.1 476.6,300.3 476.6,88.5 468.5,71.8 461.4,57.1 	431,57.1 408.9,68.8 408.9,82.8 408.9,635.7 415.8,644.1 424.4,652.7 463.2,652.7 "/>
              <line class="st3" x1="442.7" y1="97.5" x2="442.7" y2="320.3"/>
              <line class="st3" x1="442.7" y1="413.3" x2="442.7" y2="625"/>
              <line class="st3" x1="675.3" y1="97.5" x2="675.3" y2="320.3"/>
              <line class="st3" x1="675.3" y1="413.3" x2="675.3" y2="625"/>
   
           <circle class="st4" cx="558.3" cy="368.1" r="20.2"/>
              <circle class="st4" cx="444.6" cy="368.5" r="20.2"/>
              <circle class="st4" cx="675.3" cy="368.5" r="20.2"/>
              <polyline class="st0" points="73.1,628.1 73.1,88.5 65,71.8 57.9,57.1 5.4,57.1 5.4,652.7 59.8,652.7 "/>
              <polyline class="st0" points="73.1,282.1 292.6,62.6 351,62.6 351,88 107.5,331.5 96.3,343.6 72.5,343.6 "/>
   
           <line class="st3" x1="39.2" y1="75.3" x2="39.2" y2="298.2"/>
              <line class="st3" x1="39.2" y1="419.7" x2="39.2" y2="642.5"/>
              <polyline class="st7" points="315.1,63.2 315.1,91.8 124.1,275.5 "/>
              <circle class="st4" cx="39.2" cy="358.9" r="20.2"/>
              <circle class="st4" cx="83.8" cy="310.9" r="20.2"/>
          
    <polyline class="st0" points="73.1,429.7 292.6,649.1 351,649.1 351,623.8 107.5,380.2 96.3,368.1 72.5,368.1 "/>
              <circle class="st4" cx="84" cy="401.1" r="20.2"/>
              <polyline class="st7" points="315.1,648.7 315.1,620.1 124.1,435.3 "/>
              <line class="st3" x1="640" y1="368.1" x2="476.6" y2="368.1"/>
              <line class="st3" x1="558.3" y1="397.8" x2="558.3" y2="339.2"/>
            
</svg>
            <span class="dot dot-bottom">•</span>
            <span class="dot dot-left">•</span>
            <span class="dot dot-right">•</span>
          </a>
          <label for="theme-checkbox" class="icon-button theme-toggle-label" title="Toggle theme">
            <span id="theme-toggle" class="icon-button">
              <span id="theme-dot"></span>
    
        </span>
          </label>
        </div>
        <div class="mobile-footer-links">
          <a href="#section-2" data-navlink="section-2">Work</a>
          <a href="#section-3" data-navlink="section-3">Services</a>
          <a href="#section-4" data-navlink="section-4">Inquiries</a>
        </div>
             </footer>

      <div 
class="sidebar-left">
        <a href="#" data-navlink="section-1" class="nav-link logo-button active">
          <svg class="logo-svg" viewBox="0 0 712.7 712" xmlns="http://www.w3.org/2000/svg">
            <polyline class="st0" points="640,628.1 640,443.7 645.9,427.9 645.9,315.1 640,300.3 640,88.5 648.1,71.8 655.2,57.1 685.6,57.1 	707.7,68.8 707.7,82.8 707.7,635.7 700.8,644.1 692.2,652.7 653.3,652.7 "/>
            <polygon class="st0" points="640,327.8 630,327.8 623,339.2 500.2,339.2 485.8,327.8 476.6,327.8 476.6,408.5 485.2,408.5 	498.3,398.5 615.8,398.5 629.1,408.5 640,408.5 "/>
            <polyline class="st0" points="476.6,628.1 476.6,443.7 
470.6,427.9 470.6,315.1 476.6,300.3 476.6,88.5 468.5,71.8 461.4,57.1 	431,57.1 408.9,68.8 408.9,82.8 408.9,635.7 415.8,644.1 424.4,652.7 463.2,652.7 "/>
            <line class="st3" x1="442.7" y1="97.5" x2="442.7" y2="320.3"/>
            <line class="st3" x1="442.7" y1="413.3" x2="442.7" y2="625"/>
            <line class="st3" x1="675.3" y1="97.5" x2="675.3" y2="320.3"/>
            <line class="st3" x1="675.3" y1="413.3" x2="675.3" y2="625"/>
            <circle class="st4" cx="558.3" cy="368.1" r="20.2"/>
   
         <circle class="st4" cx="444.6" cy="368.5" r="20.2"/>
            <circle class="st4" cx="675.3" cy="368.5" r="20.2"/>
            <polyline class="st0" points="73.1,628.1 73.1,88.5 65,71.8 57.9,57.1 5.4,57.1 5.4,652.7 59.8,652.7 "/>
            <polyline class="st0" points="73.1,282.1 292.6,62.6 351,62.6 351,88 107.5,331.5 96.3,343.6 72.5,343.6 "/>
            <line class="st3" x1="39.2" y1="75.3" x2="39.2" y2="298.2"/>
            
<line class="st3" x1="39.2" y1="419.7" x2="39.2" y2="642.5"/>
            <polyline class="st7" points="315.1,63.2 315.1,91.8 124.1,275.5 "/>
            <circle class="st4" cx="39.2" cy="358.9" r="20.2"/>
            <circle class="st4" cx="83.8" cy="310.9" r="20.2"/>
            <polyline class="st0" points="73.1,429.7 292.6,649.1 351,649.1 351,623.8 107.5,380.2 96.3,368.1 72.5,368.1 "/>
            <circle class="st4" cx="84" cy="401.1" r="20.2"/>
         
   <polyline class="st7" points="315.1,648.7 315.1,620.1 124.1,435.3 "/>
            <line class="st3" x1="640" y1="368.1" x2="476.6" y2="368.1"/>
            <line class="st3" x1="558.3" y1="397.8" x2="558.3" y2="339.2"/>
          </svg>
          <span class="dot dot-bottom">•</span>
          <span class="dot dot-left">•</span>
          <span class="dot dot-right">•</span>
        </a>
    
    <div class="sidebar-left-bottom-content">
          <button id="desktop-about-button" class="icon-button info-button desktop-info-button" aria-label="About">
            <svg viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
           
 </svg>
          </button>
          <label for="theme-checkbox" class="theme-toggle-label" title="Toggle theme">
            <span id="theme-toggle" class="icon-button">
              <span id="theme-dot"></span>
            </span>
          </label>
        </div>
      </div>

      <nav class="nav-stacked-left">
        <a href="#" data-navlink="section-2" class="nav-link-left">
          <span class="nav-number">•</span>
          <span class="nav-text vertical-text">Work</span>
        </a>
        <a href="#" data-navlink="section-3" class="nav-link-left">
          <span class="nav-number">••</span>
          <span class="nav-text vertical-text">Services</span>
        </a>
     
   <a href="#" data-navlink="section-4" class="nav-link-left">
          <span class="nav-number">•••</span>
          <span class="nav-text vertical-text">Inquiries</span>
        </a>
      </nav>

      <main>
        <section id="section-1">
          <div class="section-1-wrapper"> 
     
       <div class="section-grid">
              <div class="text-column">

              </div>
            </div>

            <div class="marquee-container">
              <div class="marquee-content-wrapper">
                <div class="marquee-content">
      
            <span>Kelvin Hernan</span>
                  <span>Kelvin Hernan</span>
                  <span>Kelvin Hernan</span>
                  <span>Kelvin Hernan</span>
                  <span>Kelvin Hernan</span>
           
       <span>Kelvin Hernan</span>
                  <span>Kelvin Hernan</span>
                  <span>Kelvin Hernan</span>
                </div>
                <div class="marquee-content" aria-hidden="true">
                  <span>Kelvin Hernan</span>
 
                 <span>Kelvin Hernan</span>
                  <span>Kelvin Hernan</span>
                  <span>Kelvin Hernan</span>
                  <span>Kelvin Hernan</span>
                  <span>Kelvin Hernan</span>
      
            <span>Kelvin Hernan</span>
                  <span>Kelvin Hernan</span>
                </div>
              </div>
            </div>
          </div>
        </section>

        
<section id="section-2" class="center-section">
          <div class="section-content">

    <main class="portfolio-main">
        <div class="portfolio-nav">
            <div class="category-group">
                <button class="section-btn active" data-gallery="3d"><span>3D</span></button>
            </div>
   
         <div class="category-group">
                <button class="section-btn" data-gallery="graphic"><span>Graphic</span></button>
            </div>
            <div class="category-group">
                <button class="section-btn" data-gallery="product"><span>Product</span></button>
            </div>
        </div>

        <div class="portfolio-content-area">

            <div class="portfolio-gallery">
                <div class="scroller active" id="scroller-3d">
                    <div class="portfolio-item">3D Project 1</div>
               
     <div class="portfolio-item">3D Project 2</div>
                    <div class="portfolio-item">3D Project 3</div>
                    <div class="portfolio-item">3D Project 4</div>
                    <div class="portfolio-item">3D Project 5</div>
                    <div class="portfolio-item">3D Project 
6</div>
                    <div class="portfolio-item">3D Project 7</div>
                </div>

                <div class="scroller" id="scroller-graphic">
                    <div class="portfolio-item">Graphic Design 1</div>
                    
<div class="portfolio-item">Graphic Design 2</div>
                    <div class="portfolio-item">Graphic Design 3</div>
                    <div class="portfolio-item">Graphic Design 4</div>
                    <div class="portfolio-item">Graphic Design 5</div>
                    <div class="portfolio-item">Graphic Design 6</div>
     
           </div>

                <div class="scroller" id="scroller-product">
                    <div class="portfolio-item">Product Shot 1</div>
                    <div class="portfolio-item">Product Shot 2</div>
                    <div class="portfolio-item">Product Shot 3</div>
  
                  <div class="portfolio-item">Product Shot 4</div>
                    <div class="portfolio-item">Product Shot 5</div>
                    <div class="portfolio-item">Product Shot 6</div>
                    <div class="portfolio-item">Product Shot 7</div>
          
          <div class="portfolio-item">Product Shot 8</div>
                </div>
            </div>

            <div class="portfolio-info">
                <div class="info-content active" data-info="3d">
           
         <h3>3D Artwork</h3>
                    <p>Welcome to my 3D gallery.
This collection showcases my work in modeling, texturing, and rendering.
I specialize in creating realistic environments and assets using tools like Blender, Substance Painter, and V-Ray.</p>
                    <p>Scroll through the gallery to see detailed shots of character models, architectural visualizations, and prop designs.</p>
                </div>
                <div class="info-content" data-info="graphic">
                
    <h3>Graphic Design</h3>
                    <p>This section highlights my graphic design portfolio.
My philosophy centers on clean, communicative, and compelling visuals. I have experience in branding, UI/UX design, and print media.</p>
                    <p>You'll find examples of logo systems, mobile app interfaces, and editorial layouts.</p>
                </div>
                <div class="info-content" data-info="product">
                 
   <h3>Product Photography</h3>
                    <p>Explore my product photography, where the goal is to make every item tangible and desirable.
I focus on capturing precise details, rich textures, and perfect lighting to showcase products in their best possible light.</p>
                    <p>This gallery features work for e-commerce, advertising, and catalogs.</p>
                </div>
            </div>

        </div>
    </main>

    <div 
class="portfolio-modal" id="portfolio-modal">
        <div class="modal-gall">
            <div class="modal-gall-inner" id="modal-gall-inner">
                </div>
        </div>
    </div>
            
          </div>
        
</section>

        <section id="section-3" class="center-section">
          <div class="section-content">

    <div class="container">
      <div class="grid-side">
        <div class="grid-item" data-service="art">
          <img src="https://placehold.co/600x400/1a1a1a/ffffff?text=Art" class="grid-item-bg">
          <div class="grid-item-content"><div class="circle"></div><h3 class="item-title">Art Direction</h3></div>
        </div>

        
<div class="grid-item" data-service="ux">
          <img src="https://placehold.co/600x400/1a1a1a/ffffff?text=Design" class="grid-item-bg">
          <div class="grid-item-content"><div class="circle"></div><h3 class="item-title">UX/UI</h3></div>
        </div>

        <div class="grid-item" data-service="branding">
          <img src="https://placehold.co/600x400/1a1a1a/ffffff?text=Brand" class="grid-item-bg">
          <div class="grid-item-content"><div class="circle"></div><h3 class="item-title">Branding</h3></div>
        </div>

        <div class="grid-item" data-service="development">
          <img src="https://placehold.co/600x400/1a1a1a/ffffff?text=Code" 
class="grid-item-bg">
          <div class="grid-item-content"><div class="circle"></div><h3 class="item-title">Development</h3></div>
        </div>

        <div class="grid-item" data-service="strategy">
          <img src="https://placehold.co/600x400/1a1a1a/ffffff?text=Strategy" class="grid-item-bg">
          <div class="grid-item-content"><div class="circle"></div><h3 class="item-title">Strategy</h3></div>
        </div>

        <div class="grid-item" data-service="photography">
          <img src="https://placehold.co/600x400/1a1a1a/ffffff?text=Photo" class="grid-item-bg">
          <div class="grid-item-content"><div class="circle"></div><h3 class="item-title">Photography</h3></div>
 
       </div>

        <div class="grid-item" data-service="motion">
          <img src="https://placehold.co/600x400/1a1a1a/ffffff?text=Motion" class="grid-item-bg">
          <div class="grid-item-content"><div class="circle"></div><h3 class="item-title">Motion</h3></div>
        </div>
      </div>

      <div class="display-side">
        <div class="service-content" data-service="default">
          <div class="service-content-inner">
            <h2>Key Services</h2>
   
         <p>This is what I focus on.<br>Additional services are available upon request.</p>
          </div>
        </div>

        <div class="service-content" data-service="art"><div class="service-content-inner"><h2>Art Direction</h2><p>Creating compelling visual narratives.</p></div></div>
        <div class="service-content" data-service="ux"><div class="service-content-inner"><h2>UX/UI</h2><p>Designing intuitive digital experiences.</p></div></div>
        <div class="service-content" data-service="branding"><div class="service-content-inner"><h2>Branding</h2><p>Building memorable brand identities.</p></div></div>
        <div class="service-content" data-service="development"><div class="service-content-inner"><h2>Development</h2><p>Modern, clean, performant builds.</p></div></div>
      
  <div class="service-content" data-service="strategy"><div class="service-content-inner"><h2>Strategy</h2><p>Data-driven planning.</p></div></div>
        <div class="service-content" data-service="photography"><div class="service-content-inner"><h2>Photography</h2><p>High-impact visual storytelling.</p></div></div>
        <div class="service-content" data-service="motion"><div class="service-content-inner"><h2>Motion</h2><p>Dynamic motion graphics.</p></div></div>
      </div>
    </div>

          </div>
        </section>

        <section id="section-4" class="center-section">
          <div class="section-content">
    
        <div class="text-container">
              <div class="copyable-text" id="textToCopy" data-copy="YADADA@GMAIL.COM">
                YADADA@GMAIL.COM
              </div>
              <div class="copy-circle" id="copyButton">Copy Me</div>
            </div>

            <canvas id="breathingGrid"></canvas>
  
        </div> </section>
        <div id="modal-container-side">
          <div class="modal-background">
            <div class="modal-content">
              <div class="modal-panel left">
      
          <p class="ls">
                  I began my journey in 2019 with a focus on 3D and digital design, gradually expanding my expertise into animation and interactive development.
Today, as an independent designer, I combine design, programming, and 3D visualization to deliver innovative and impactful solutions.
<br>
                  <br>
                  My work spans two complementary areas.
For brands and companies, I design and develop interactive interfaces and experiences that prioritize clarity, function, and meaningful outcomes.
In parallel, I create 3D-driven visual art for musicians and public figures, producing work that blends technical precision with narrative depth and visual impact.
</p>

                <br>   <p class="ls">
                CONTACT:
                YADADA@GMAIL.COM
                 </p>
                <br>   <p class="ls">
           
     LINKEDIN
                </p>
              </div>
              <div class="modal-panel right">
                <div class="bb">
                  <img src="https://assets.codepen.io/1480814/av+1.png" alt="Masked">
            
    </div> 
              </div>
            </div>
          </div>
        </div>

      </main>

      <nav class="nav-stacked-right">
        <a href="#" data-navlink="section-2" class="nav-link">
          <span class="nav-number">•</span>
   
       <span class="nav-text vertical-text">Work</span>
        </a>
        <a href="#" data-navlink="section-3" class="nav-link">
          <span class="nav-number">••</span>
          <span class="nav-text vertical-text">Services</span>
        </a>
        <a href="#" data-navlink="section-4" class="nav-link">
          <span class="nav-number">•••</span>
          <span class="nav-text vertical-text">Inquiries</span>
       
 </a>
      </nav>

    </div> <script type="importmap">
      {
        "imports": {
          "three": "https://cdn.skypack.dev/three@0.136.0"
        }
      }
    </script>


    <script type="module">
      import * as THREE from 'three';
let scene, camera, renderer, p, planet, torus1, torus2, torus3; // ADDED torus3
      let currentSphereColor = null;
const container = document.getElementById('canvas-container');

      let gu, sizes = [], shift = [], clock;
function getSpherePoints(count, radius) {
        const points = [];
for (let i = 0; i < count; i++) {
          const phi = Math.acos(-1 + (2 * i) / count);
const theta = Math.sqrt(count * Math.PI) * phi;
          const p = new THREE.Vector3();
          p.setFromSphericalCoords(radius, phi, theta);
          points.push(p);
}
        return points;
}

      function getTorusPoints(count, radius, tube, tiltX, tiltY) {
        const points = [];
for (let i = 0; i < count; i++) {
          const u = (i / count) * Math.PI * 2;
const v = ((i * 137.5) % count / count) * Math.PI * 2;
const x = (radius + tube * Math.cos(v)) * Math.cos(u);
          const y = (radius + tube * Math.cos(v)) * Math.sin(u);
const z = tube * Math.sin(v);

          const p = new THREE.Vector3(x, y, z);
          p.applyEuler(new THREE.Euler(tiltX, tiltY, 0));
          points.push(p);
}
        return points;
}

      function initThreeJS() {
        scene = new THREE.Scene();
const initialBgColor = getComputedStyle(document.body).getPropertyValue('--bg-color').trim();
        scene.background = new THREE.Color(initialBgColor);

        const fov = 75;
        const aspect = window.innerWidth / window.innerHeight;
const near = 0.1;
        const far = 1000;
        camera = new THREE.PerspectiveCamera(fov, aspect, near, far);
const isDesktop = window.innerWidth >= 1025;
        camera.position.z = isDesktop ? 5.25 : 8;
renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        container.appendChild(renderer.domElement);

        const initialColor = getComputedStyle(document.body).getPropertyValue('--sphere-color').trim();
currentSphereColor = parseInt(initialColor, 16);

        const planetGeometry = new THREE.SphereGeometry(0.5, 32, 32);
const planetMaterial = new THREE.MeshBasicMaterial({ 
          color: currentSphereColor,
          transparent: false
        });
planet = new THREE.Mesh(planetGeometry, planetMaterial);
        scene.add(planet);

        const torusGeometry1 = new THREE.TorusGeometry(3, 0.0125, 16, 100);
const torusMaterial1 = new THREE.MeshBasicMaterial({ 
          color: currentSphereColor,
          transparent: false,
          opacity: 1.0
        });
torus1 = new THREE.Mesh(torusGeometry1, torusMaterial1);
        torus1.rotation.set(Math.PI / 2.5, Math.PI / 4, 0);
        scene.add(torus1);
const torusGeometry2 = new THREE.TorusGeometry(3, 0.0125, 16, 100);
        const torusMaterial2 = new THREE.MeshBasicMaterial({ 
          color: currentSphereColor,
          transparent: false,
          opacity: 1.0
        });
torus2 = new THREE.Mesh(torusGeometry2, torusMaterial2);
        torus2.rotation.set(Math.PI / 2.5, -Math.PI / 4, 0);
        scene.add(torus2);
const torusGeometry3 = new THREE.TorusGeometry(3, 0.0125, 16, 100); // NEW
        const torusMaterial3 = new THREE.MeshBasicMaterial({ // NEW
          color: currentSphereColor, // NEW
          transparent: false, // NEW
          opacity: 1.0 // NEW
        });
// NEW
        torus3 = new THREE.Mesh(torusGeometry3, torusMaterial3);
// NEW
        torus3.rotation.set(Math.PI / 2.5, 0, 0);
// NEW - Y rotation is 0
        scene.add(torus3);
// NEW

        gu = { time: { value: 0 } };
sizes = [];
        shift = [];

        let pushShift = () => {
          shift.push(
            Math.random() * Math.PI, 
            Math.random() * Math.PI * 2, 
            (Math.random() * 0.9 + 0.1) * Math.PI * 0.1,
            Math.random() * 0.25 + 0.1
          );
}

        const torus1Points = getTorusPoints(100, 3, 0.0125, Math.PI / 2.5, Math.PI / 4);
const torus2Points = getTorusPoints(100, 3, 0.0125, Math.PI / 2.5, -Math.PI / 4);
// const torus3Points = getTorusPoints(100, 3, 0.0125, Math.PI / 2.5, 0);
// REMOVED from particles
        const outerSpherePoints = getSpherePoints(100, 6.5);
const pts = [...torus1Points, ...torus2Points, ...outerSpherePoints]; // MODIFIED: Removed torus3Points

        pts.forEach(pt => {
          sizes.push(Math.random() * 0.5 + 1);
          pushShift();
        });
let g = new THREE.BufferGeometry().setFromPoints(pts);
        g.setAttribute("sizes", new THREE.Float32BufferAttribute(sizes, 1));
        g.setAttribute("shift", new THREE.Float32BufferAttribute(shift, 4));
let m = new THREE.PointsMaterial({
          size: 0.1,
          transparent: true,
          depthTest: false,
          blending: THREE.AdditiveBlending,
          onBeforeCompile: shader => {
            shader.uniforms.time = gu.time;
            shader.uniforms.color = gu.color = { value: new THREE.Color(currentSphereColor) };

     
       shader.vertexShader = `
              uniform float time;
              uniform vec3 color;
              attribute float sizes;
              attribute vec4 shift;
              varying vec3 vColor;
           
   ${shader.vertexShader}
            `.replace(
              `gl_PointSize = size;`,
              `gl_PointSize = size * sizes;`
            ).replace(
              `#include <color_vertex>`,
              `#include <color_vertex>
         
       float d = length(abs(position) / vec3(40., 10., 40));
                d = clamp(d, 0., 1.);
                vColor = color;
              `
            ).replace(
              `#include <begin_vertex>`,
       
       `#include <begin_vertex>
                float t = time;
float moveT = mod(shift.x + shift.z * t, PI2);
                float moveS = mod(shift.y + shift.z * t, PI2);
transformed += vec3(cos(moveS) * sin(moveT), cos(moveT), sin(moveS) * sin(moveT)) * shift.w;
`
            );
shader.fragmentShader = `
              ${shader.fragmentShader}
            `.replace(
              `vec4 diffuseColor = vec4( diffuse, opacity );`,
              `
              vec2 uv = abs((gl_PointCoord - 0.5) * 2.);
              float d = 
length(uv - vec2(1));
              float f = 1. - step(d, 1.);
              if (f < 0.1) discard;
              vec4 diffuseColor = vec4( diffuse, opacity );`
            );
}
        });

        p = new THREE.Points(g, m);
        scene.add(p);

        clock = new THREE.Clock();
        renderer.setAnimationLoop(animate);
}

      function animate() {
        let t = clock.getElapsedTime() * 0.25;
gu.time.value = t * Math.PI;

        const newColorHex = getComputedStyle(document.body).getPropertyValue('--sphere-color').trim();
        const newColor = parseInt(newColorHex, 16);

        const newBgColor = getComputedStyle(document.body).getPropertyValue('--bg-color').trim();
        scene.background.set(newBgColor);
if (newBgColor === '#ffffff') {
          if (p) {
            p.material.blending = THREE.NormalBlending;
p.material.transparent = false;
            p.material.opacity = 1.0;
            p.material.size = 0.1;
            p.material.needsUpdate = true;
}
        } else {
          if (p) {
            p.material.blending = THREE.AdditiveBlending;
p.material.transparent = true;
            p.material.opacity = 1.0;
            p.material.size = 0.1;
            p.material.needsUpdate = true;
}
        }

        if (newColor !== currentSphereColor) {
          currentSphereColor = newColor;
if (gu.color) {
            gu.color.value.setHex(currentSphereColor);
}

          if (p && p.material) {
            p.material.color.setHex(currentSphereColor);
p.material.needsUpdate = true;
          }

          if (planet && planet.material) {
            planet.material.color.setHex(currentSphereColor);
}

          if (torus1 && torus1.material) {
            torus1.material.color.setHex(currentSphereColor);
}
          if (torus2 && torus2.material) {
            torus2.material.color.setHex(currentSphereColor);
}
          if (torus3 && torus3.material) { // NEW
            torus3.material.color.setHex(currentSphereColor);
// NEW
          } // NEW
        }

        if (p) {
          p.rotation.y += 0.001;
p.rotation.x += 0.0005;
        }

        if (planet) {
          planet.rotation.y += 0.001;
planet.rotation.x += 0.0005;
        }

        if (torus1) {
          torus1.rotation.y += 0.001;
torus1.rotation.x += 0.0005;
        }
        if (torus2) {
          torus2.rotation.y += 0.001;
torus2.rotation.x += 0.0005;
        }
        if (torus3) { // NEW
          torus3.rotation.y += 0.001;
// NEW
          torus3.rotation.x += 0.0005;
// NEW
        } // NEW

        renderer.render(scene, camera);
}

      function onWindowResize() {
        if (camera && renderer && container) {
          const aspect = window.innerWidth / window.innerHeight;
camera.aspect = aspect;

          const isDesktop = window.innerWidth >= 1025;
          camera.position.z = isDesktop ? 5.25 : 8; 

          camera.updateProjectionMatrix();
          renderer.setSize(window.innerWidth, window.innerHeight);
}
      }
      window.addEventListener('resize', onWindowResize, false);
if (container) {
        setTimeout(initThreeJS, 100);
}

      // --- Scroll Logic (Desktop & Mobile) ---

      const sections = document.querySelectorAll('section');
const numSections = sections.length;
      let currentSectionIndex = 0;

      let isWheeling = false;
      const scrollCooldown = 900;
const desktopNavLinksRight = document.querySelectorAll('.nav-stacked-right .nav-link');
      const desktopNavLinksLeft = document.querySelectorAll('.nav-stacked-left .nav-link-left');
      const desktopKHLink = document.querySelector('.sidebar-left .logo-button'); 

      const mobileFooterLinks = document.querySelectorAll('.mobile-footer-links a');
const mobileKHLink = document.querySelector('.mobile-footer-top .logo-button'); 

      const canvasContainer = document.getElementById('canvas-container');

      function updateDesktopActiveNav(index) {
        if (desktopKHLink) {
          desktopKHLink.classList.toggle('active', index === 0);
}
        desktopNavLinksRight.forEach((link, i) => link.classList.toggle('active', i < index));
desktopNavLinksLeft.forEach((link, i) => link.classList.toggle('active', i < index));

        // --- FIX: Hide right nav border when last section is active ---
        const rightNav = document.querySelector('.nav-stacked-right');
if (rightNav) {
          // numSections is defined in the global script scope
          rightNav.classList.toggle('is-complete', index === numSections - 1);
}
        // --- END FIX ---

        if (canvasContainer) {
          canvasContainer.classList.add('is-visible');
}
      }

      function scrollToSectionDesktop(index) {
        if (document.body.classList.contains('modal-active')) return;
if (index < 0 || index >= numSections || isWheeling) return; 
        if (index === currentSectionIndex) return; 

        isWheeling = true;
sections.forEach((section, i) => {
          if (i <= index) {
            section.style.transform = 'translateX(0)';
            section.classList.add('is-active'); 
          } else {
            section.style.transform = 'translateX(100%)';
            section.classList.remove('is-active'); 
          }
       
 });

        currentSectionIndex = index;
        updateDesktopActiveNav(currentSectionIndex);

        setTimeout(() => {
          isWheeling = false;
        }, scrollCooldown);
}

      let wheelTimeout = null;
      let wheelDirection = 0;
function handleDesktopWheel(e) {
        if (document.body.classList.contains('modal-active')) return;
// Check if the wheel event is happening inside a horizontally scrollable element
        let target = e.target;
let scrollerElement = null;

        while (target && target !== document.body) {
          if (target.classList && target.classList.contains('scroller')) {
            scrollerElement = target;
break;
          }
          target = target.parentElement;
}

        // If inside a scroller and scrolling horizontally (or diagonally with horizontal component)
        if (scrollerElement && Math.abs(e.deltaX) > 0) {
          // Check if there's room to scroll horizontally
          const canScrollLeft = scrollerElement.scrollLeft > 0;
const canScrollRight = scrollerElement.scrollLeft < (scrollerElement.scrollWidth - scrollerElement.clientWidth - 1);
// If there's horizontal scroll room and user is scrolling horizontally, allow it
          if ((e.deltaX < 0 && canScrollLeft) || (e.deltaX > 0 && canScrollRight)) {
            return;
// Allow natural horizontal scrolling
          }
        }

        e.preventDefault();
if (isWheeling) return; 

        if (Math.abs(e.deltaX) > Math.abs(e.deltaY)) {
          return;
}

        // Accumulate wheel direction
        wheelDirection += e.deltaY;
// Clear existing timeout
        if (wheelTimeout) {
          clearTimeout(wheelTimeout);
}

        // Wait for wheel events to finish (debounce)
        wheelTimeout = setTimeout(() => {
          if (Math.abs(wheelDirection) > 10) { // Threshold to detect intentional scroll
            if (wheelDirection > 0) {
              scrollToSectionDesktop(currentSectionIndex + 1);
            } else {
       
       scrollToSectionDesktop(currentSectionIndex - 1);
            }
          }
          wheelDirection = 0;
          wheelTimeout = null;
        }, 10);
// Short delay to group wheel events together
      }

      function handleDesktopKeydown(e) {
        if (document.body.classList.contains('modal-active')) return;
if (isWheeling) return;

        if (e.key === 'ArrowDown' || e.key === 'PageDown' || e.key === ' ') {
          e.preventDefault();
scrollToSectionDesktop(currentSectionIndex + 1);
        } else if (e.key === 'ArrowUp' || e.key === 'PageUp') {
          e.preventDefault();
scrollToSectionDesktop(currentSectionIndex - 1);
        } else if (e.key === 'Home') {
          e.preventDefault();
scrollToSectionDesktop(0);
        } else if (e.key === 'End') {
          e.preventDefault();
scrollToSectionDesktop(numSections - 1);
        }
      }

      let isSwipeProcessed = false;
function handleDesktopSwipe() {
        if (isWheeling || isSwipeProcessed) return; 
        if (document.body.classList.contains('modal-active')) return;
const swipeThreshold = 50;
        const swipeDistance = Math.abs(touchStartY - touchEndY);
if (swipeDistance > swipeThreshold) {
          isSwipeProcessed = true;
if (touchStartY - touchEndY > swipeThreshold) {
            scrollToSectionDesktop(currentSectionIndex + 1);
} else if (touchEndY - touchStartY > swipeThreshold) {
            scrollToSectionDesktop(currentSectionIndex - 1);
}

          setTimeout(() => {
            isSwipeProcessed = false;
          }, scrollCooldown);
}
      }

      let observer;
function initMobileScrollObserver() {
        if (!('IntersectionObserver' in window)) {
          console.warn('IntersectionObserver not supported, mobile nav highlighting will not work.');
document.getElementById('section-1')?.classList.add('is-active');
          if (canvasContainer) canvasContainer.classList.add('is-visible');
          return;
        }

        observer = new IntersectionObserver((entries) => {
          const mobileFooter = document.querySelector('.mobile-footer'); // Get footer once

          entries.forEach(entry => {
            const id = entry.target.id;
            if (entry.isIntersecting) {

              // === NEW LOGIC to toggle footer menu ===
  
            if (mobileFooter) {
                mobileFooter.classList.toggle('section-2-active', id === 'section-2');
              }
              // === END NEW LOGIC ===

              mobileFooterLinks.forEach(link => {
                link.classList.toggle('active', link.hash 
=== `#${id}`);
              });

              if (mobileKHLink) {
                mobileKHLink.classList.toggle('active', id === 'section-1');
              }

              entry.target.classList.add('is-active');

              if (id === 'section-1' && canvasContainer) {
  
              canvasContainer.classList.add('is-visible');
              }
            } else {
              entry.target.classList.remove('is-active');
}
          });
}, {
          root: document.querySelector('.theme-wrapper'), 
          threshold: 0.5
        });
sections.forEach(section => observer.observe(section));
      }

      function cleanupMobileScrollObserver() {
        if (observer) {
          sections.forEach(section => observer.unobserve(section));
observer.disconnect();
          observer = null;
        }
      }

      let touchStartY = 0;
let touchEndY = 0;

      function handleTouchStart(e) {
        if (document.body.classList.contains('modal-active')) return;
        touchStartY = e.changedTouches[0].screenY;
}

      function handleTouchEnd(e) {
        if (document.body.classList.contains('modal-active')) return;
touchEndY = e.changedTouches[0].screenY;

        if (window.innerWidth >= 1025) { 
          handleDesktopSwipe();
}
      }

      let isDesktop = window.innerWidth >= 1025;
function setupEventListeners() {
        if (isDesktop) {
          window.addEventListener('wheel', handleDesktopWheel, { passive: false });
window.addEventListener('keydown', handleDesktopKeydown);
          window.addEventListener('touchstart', handleTouchStart, { passive: false });
          window.addEventListener('touchend', handleTouchEnd, { passive: false });
sections.forEach((section, i) => {
            if (i === 0) {
              section.style.transform = 'translateX(0)';
              section.classList.add('is-active'); 
            } else {
              section.style.transform = 'translateX(100%)';
              section.classList.remove('is-active');
      
      }
          });
          updateDesktopActiveNav(0);

          cleanupMobileScrollObserver();
// NEW: Trigger intro animations for desktop navs
          setTimeout(() => {
              if (document.querySelector('.theme-wrapper')) {
                document.querySelector('.theme-wrapper').classList.add('is-loaded');
              }
          }, 100);
// Small delay to ensure initial styles are applied

        } else {
          window.removeEventListener('wheel', handleDesktopWheel);
window.removeEventListener('keydown', handleDesktopKeydown);
          window.removeEventListener('touchstart', handleTouchStart);
          window.removeEventListener('touchend', handleTouchEnd);

          sections.forEach(section => {
            section.style.transform = '';
          });
initMobileScrollObserver();
        }
      }

      window.addEventListener('resize', () => {
        onWindowResize();

        const newIsDesktop = window.innerWidth >= 1025; 
        if (newIsDesktop !== isDesktop) {
          isDesktop = newIsDesktop;
          setupEventListeners();
        }
      });
document.querySelectorAll('.nav-link, .nav-link-left, .sidebar-left .logo-button').forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault(); 
          if (isDesktop) {
            if (document.body.classList.contains('modal-active')) return;
            const targetId = link.getAttribute('data-navlink');
            if (!targetId) return; 

            const targetIndex = parseInt(targetId.split('-')[1]) - 
1;
            if (targetIndex !== currentSectionIndex) {
              scrollToSectionDesktop(targetIndex); 
            }
          }
        });
      });
document.querySelectorAll('.mobile-footer-top a, .mobile-footer-links a').forEach(link => {
        link.addEventListener('click', (e) => {
          if (!isDesktop) {
            e.preventDefault();
            const targetId = link.getAttribute('href');
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
              targetElement.scrollIntoView({ behavior: 
'smooth' });
            }
          } else {
            e.preventDefault();
          }
        });
      });
setupEventListeners();
    </script>

    <script>
      $(document).ready(function() {
        $('#desktop-about-button, #mobile-about-button').on('click', function(e){
          e.preventDefault();

          const modal = $('#modal-container-side');

          if (modal.hasClass('visible')) {
            modal.addClass('out');
            $('body').removeClass('modal-active');
          } 
else {
            modal.removeAttr('class').addClass('visible');
            $('body').addClass('modal-active');
          }
        });

        $('#modal-container-side').on('click', function(e){
          if ($(e.target).is('.modal-background')) {
            $(this).addClass('out');
            $('body').removeClass('modal-active');
          }
  
      });

        $('#modal-container-side').on('animationend webkitAnimationEnd', function(e) {
          if (e.target === this && $(this).hasClass('out')) {
            $(this).removeAttr('class');
          }
        });
      });
</script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const themeCheckbox = document.getElementById('theme-checkbox');
        if (themeCheckbox) {
          themeCheckbox.addEventListener('change', function() {
            document.body.classList.toggle('light-mode', this.checked);
          });

          document.body.classList.toggle('light-mode', themeCheckbox.checked);
        }
 
     });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const buttons = document.querySelectorAll('.section-btn');
            const mobileWorkNavLinks = document.querySelectorAll('.mobile-work-nav-link'); // For future use
            const scrollers = {
                '3d': document.getElementById('scroller-3d'),
             
   'graphic': document.getElementById('scroller-graphic'),
                'product': document.getElementById('scroller-product')
            };
            
            // Select info content
            const infoContents = {
                '3d': document.querySelector('.info-content[data-info="3d"]'),
        
        'graphic': document.querySelector('.info-content[data-info="graphic"]'),
                'product': document.querySelector('.info-content[data-info="product"]')
            };

            // NEW: Save scroll positions
            const scrollPositions = {
                '3d': 0,
              
  'graphic': 0,
                'product': 0
            };
let currentGallery = '3d';

            function updateProgress(scroller, button) {
                if (!button) return;
const scrollLeft = scroller.scrollLeft;
                const scrollWidth = scroller.scrollWidth - scroller.clientWidth;
                const progress = scrollWidth > 0 ?
(scrollLeft / scrollWidth) * 100 : 0;
                button.style.setProperty('--progress', `${progress}%`);
            }

            // UPDATED: Function now also switches info content and saves/restores scroll
            function switchGallery(newGallery) {
                if (newGallery === currentGallery) return;
// Save current scroll position
                scrollPositions[currentGallery] = scrollers[currentGallery].scrollLeft;
// --- Gallery Scroller ---
                scrollers[currentGallery].classList.remove('active');
scrollers[newGallery].classList.add('active');
                // Restore new gallery's scroll position
                scrollers[newGallery].scrollLeft = scrollPositions[newGallery];
// --- Info Content ---
                infoContents[currentGallery].classList.remove('active');
infoContents[newGallery].classList.add('active');

                currentGallery = newGallery;

                const activeButton = document.querySelector(`.section-btn[data-gallery="${newGallery}"]`);
                const activeMobileLink = document.querySelector(`.mobile-work-nav-link[data-gallery="${newGallery}"]`);
                updateProgress(scrollers[newGallery], activeButton);
                updateProgress(scrollers[newGallery], activeMobileLink);
}

            buttons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const galleryType = btn.dataset.gallery;
                    buttons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');

  
                  // Sync mobile links
                    mobileWorkNavLinks.forEach(l => l.classList.remove('active'));
                    const matchingLink = document.querySelector(`.mobile-work-nav-link[data-gallery="${galleryType}"]`);
                    matchingLink?.classList.add('active');

              
      switchGallery(galleryType);
                });
            });
// Add listeners for mobile links
            mobileWorkNavLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const galleryType = link.dataset.gallery;

                   
 mobileWorkNavLinks.forEach(l => l.classList.remove('active'));
                    link.classList.add('active');

                    // Sync desktop/tablet buttons
                    buttons.forEach(b => b.classList.remove('active'));
                    const matchingButton = document.querySelector(`.section-btn[data-gallery="${galleryType}"]`);
         
           matchingButton?.classList.add('active');

                    switchGallery(galleryType);
                });
            });
Object.keys(scrollers).forEach(key => {
                scrollers[key].addEventListener('scroll', () => {
                    if (key === currentGallery) {
                        const activeButton = document.querySelector(`.section-btn[data-gallery="${key}"]`);
                        const activeMobileLink = document.querySelector(`.mobile-work-nav-link[data-gallery="${key}"]`);
 
                       
                        updateProgress(scrollers[key], activeButton);
                        updateProgress(scrollers[key], activeMobileLink);

                        // NEW: Save 
scroll position as user scrolls
                        scrollPositions[key] = scrollers[key].scrollLeft;
                    }
                });
            });
const initialButton = document.querySelector(`.section-btn[data-gallery="${currentGallery}"]`);
            const initialMobileLink = document.querySelector(`.mobile-work-nav-link[data-gallery="${currentGallery}"]`);
            updateProgress(scrollers[currentGallery], initialButton);
            updateProgress(scrollers[currentGallery], initialMobileLink);
// --- NEW: Lightbox/Modal Logic ---
            const modal = document.getElementById('portfolio-modal');
const modalContentInner = document.getElementById('modal-gall-inner');
            const portfolioItems = document.querySelectorAll('.portfolio-item');

            portfolioItems.forEach(item => {
                item.addEventListener('click', () => {
                    // Clone the item's content (in this case, just the text)
                    const itemContent = item.innerHTML; 
                 
   modalContentInner.innerHTML = itemContent;
                    
                    // Show the modal
                    modal.classList.add('active');
                });
            });
function closeModal() {
                modal.classList.remove('active');
// Clear content after transition
                setTimeout(() => {
                    modalContentInner.innerHTML = '';
                }, 300);
}

            // Close modal by clicking on the background or the content
            modal.addEventListener('click', closeModal);
modalContentInner.addEventListener('click', closeModal);
        });
    </script>
   <script>
      const isMobile = window.matchMedia("(max-width: 1024px)").matches;
if (isMobile) {
        const items = document.querySelectorAll(".grid-item");
items.forEach(item => {
          item.addEventListener("click", () => {
            const service = item.getAttribute("data-service");

            items.forEach(i => i.classList.remove("active"));
            document.querySelectorAll(".service-content").forEach(s => s.classList.remove("active"));

            item.classList.add("active");
            document.querySelector(`.service-content[data-service="${service}"]`).classList.add("active");

            document.body.classList.add("mobile-has-active");
      
    });
        });
}
    </script>
    <script>

      const canvas = document.getElementById('breathingGrid');
const ctx = canvas.getContext('2d');
      const textEl = document.getElementById('textToCopy');
      let dots = [];
      let spacing = 80;
let mouse = { x: -1000, y: -1000 };

      // Function to get current theme color
      function getThemeColor() {
        try {
          const computedStyle = getComputedStyle(document.body);
const textColor = computedStyle.getPropertyValue('--text-color').trim();

          // Convert hex to RGB
          if (textColor && textColor.startsWith('#')) {
            const hex = textColor.replace('#', '');
const r = parseInt(hex.substring(0, 2), 16);
            const g = parseInt(hex.substring(2, 4), 16);
            const b = parseInt(hex.substring(4, 6), 16);
// Validate the parsed values
            if (!isNaN(r) && !isNaN(g) && !isNaN(b)) {
              return { r, g, b };
}
          }
        } catch (e) {
          console.error('Error parsing theme color:', e);
}

        // Default to white for dark theme (base theme)
        return { r: 255, g: 255, b: 255 };
}

      function resizeCanvas() {
        // NEW: Size canvas to its parent container (.section-content)
        const rect = canvas.parentElement.getBoundingClientRect();
canvas.width = rect.width;
        canvas.height = rect.height;

        // Adjust spacing for mobile
        spacing = canvas.width < 480 ?
40 : canvas.width < 768 ? 60 : 80;
        dots = [];
// NEW: Calculate grid and center it, creating padding at edges
        const numCols = Math.floor(canvas.width / spacing) + 1;
const numRows = Math.floor(canvas.height / spacing) + 1;

        const gridWidth = (numCols - 1) * spacing;
const gridHeight = (numRows - 1) * spacing;

        const offsetX = (canvas.width - gridWidth) / 2;
const offsetY = (canvas.height - gridHeight) / 2;

        for(let r = 0; r < numRows; r++){
          for(let c = 0; c < numCols; c++){
            dots.push({ x: (c * spacing) + offsetX, y: (r * spacing) + offsetY });
}
        }
      }

      resizeCanvas();
window.addEventListener('resize', resizeCanvas);

      window.addEventListener('mousemove', (e)=>{
        const rect = canvas.getBoundingClientRect();
        mouse.x = e.clientX - rect.left;
        mouse.y = e.clientY - rect.top;
      });
let time = 0;
      function animate() {
        time += 0.016;
        ctx.clearRect(0,0,canvas.width,canvas.height);
// NEW: Get coordinates relative to the canvas
        const rect = textEl.getBoundingClientRect();
const canvasRect = canvas.getBoundingClientRect();
        const textPadding = 20;

        // Calculate text box boundaries in canvas-relative coordinates
        const textLeft = rect.left - canvasRect.left - textPadding;
const textRight = rect.right - canvasRect.left + textPadding;
        const textTop = rect.top - canvasRect.top - textPadding;
const textBottom = rect.bottom - canvasRect.top + textPadding;

        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
const waveSpeed = 60;
        const waveThickness = 40;
        const maxDist = Math.hypot(centerX, centerY) + waveThickness;
const currentWave = (time * waveSpeed) % maxDist;

        // Get current theme color
        const color = getThemeColor();
dots.forEach(dot=>{
          if(dot.x > textLeft && dot.x < textRight && dot.y > textTop && dot.y < textBottom){
            return;
          }
          const dist = Math.hypot(dot.x - centerX, dot.y - centerY);
          const distToWave = Math.abs(dist - currentWave);
          let pulseFactor = 0;
        
  if(distToWave < waveThickness/2){
            pulseFactor = 1 - distToWave / (waveThickness/2);
            pulseFactor = Math.sin(pulseFactor*Math.PI/2);
          }
          const mouseDist = Math.hypot(dot.x - mouse.x, dot.y - mouse.y);
          let glowFactor = 0;
          const glowRadius = 50;
          
if(mouseDist < glowRadius){
            glowFactor = (1 - mouseDist/glowRadius);
          }
          const size = (canvas.width < 480 ? 2 : 4) + pulseFactor*12 + glowFactor*10;
          const opacity = Math.min(1, 0.2 + pulseFactor*0.8 + glowFactor*0.9);
          ctx.beginPath();
          ctx.arc(dot.x, dot.y, size, 0, Math.PI*2);
       
   // Use theme color instead of hardcoded white
          ctx.fillStyle = `rgba(${color.r}, ${color.g}, ${color.b}, ${opacity})`;
ctx.fill();
        });
        requestAnimationFrame(animate);
      }

      animate();
// Copy button logic
      const copyButton = document.getElementById('copyButton');
function copyToClipboard() {
        const textToCopy = textEl.getAttribute('data-copy') || textEl.textContent.replace(/^EMAIL:\s*/i, '');
navigator.clipboard.writeText(textToCopy).then(() => {
          copyButton.textContent = 'Copied!';
          copyButton.classList.add('copied');
          setTimeout(() => {
            copyButton.textContent = 'Copy Me';
            copyButton.classList.remove('copied');
          }, 1500);
        }).catch(err => console.error(err));
}

      copyButton.addEventListener('click', copyToClipboard);
      textEl.addEventListener('click', copyToClipboard);
      textEl.addEventListener('touchstart', (e) => e.preventDefault());

    </script>
  </body>
</html>
